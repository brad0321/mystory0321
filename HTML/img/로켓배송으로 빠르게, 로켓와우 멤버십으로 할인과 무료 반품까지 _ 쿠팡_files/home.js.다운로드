define("CategoryBest",["jquery","handlebars","../lib/jquery/plugin/jquery-ui.sortable.min","common/baseAction","common/utils/cookieUtils","common/utils/browserChecker","common/essentialData","common/adsplatform/ViewableImpressionLogger","text!template/search/searchAdBadgeTooltip.html","couLog"],(function(e,t,n,i,o,a,s,r,c,d){"use strict";var l=e(".ad-badge"),u={},m={};coupangWebRequire(["HomeWebLogSchemas"],(function(t){u=e.extend(u,t.BASE_LOG_PARAMS),m=e.extend(u,t.LOG_PARAMS)}));var p=function(t){this.domName={win:e(window),root:"#categoryBestUnit",categoryBoxList:"#categoryBestUnit .category-best-unit",promotions:"#categoryBestUnit .promotion",productLists:"#categoryBestUnit .best-product-list",categoryBestLink:"#categoryBestUnit .category-best-link",menu:"#categoryBestMenu",menuCategoryBtnList:"#categoryBestMenu .category-anchor",settingButton:"#categoryBestMenu .setting",settingLayer:"#categoryBestMenu .set-category-layer",settingLayerTail:"#categoryBestMenu .box-tail",settingCategoryListWrap:"#categoryBestMenu .set-category-list",settingCategoryList:"#categoryBestMenu .set-category-list li",settingCategoryCheckbox:"#categoryBestMenu .set-category-list input[type=checkbox]"},this.callBackFn=t||function(){},this.init()};function g(){e("body").prepend(e(".ad-badge-tooltip"));var n=t.compile(c);e("body").append(n());var i=e(".ad-badge-tooltip");l.on("mouseover",".ad-badge-svg",(function(t){var n=e(t.currentTarget).offset();n&&i.css({top:n.top,left:n.left}).show()})),l.on("mouseout",".ad-badge-svg",(function(e){i.hide()})),navigator.appVersion.indexOf("Win")>-1&&i.css("letter-spacing","-1.5px")}return p.prototype={init:function(){for(var t in this.elements={},this.domName)this.elements[t]=e(this.domName[t]);this.setElementPosition(),this.activateCategoryButton(),this.setCategory(),"B"===s.getAbTestOptionByKey("2491")&&this.setSettingLayerHeight(),this.sendImpression(),this.bindEvent()},orderingCategory:function(t,n){if(!t)return!1;n=n||this.categories.display;for(var i=t.length-1;i>=0;i--){var o=this.elements.settingCategoryCheckbox.filter("[data-display-category="+t[i]+"]").parents("li");o.prependTo(o.parent())}this.elements.settingCategoryCheckbox.prop("checked",!1),e.each(n,e.proxy((function(e,t){this.elements.settingCategoryListWrap.find("[data-display-category="+t+"]").prop("checked",!0),this.elements.settingCategoryListWrap.find("[data-display-category="+t+"]").next().css("opacity","1")}),this))},setCategory:function(){this.categories={data:this.elements.root.data("categories")?this.elements.root.data("categories").split(","):[],display:[],_default:this.elements.settingCategoryListWrap.data("default-category-list")?this.elements.settingCategoryListWrap.data("default-category-list").split(","):[]},e.each(this.elements.categoryBoxList,e.proxy((function(t,n){var i=e(n).attr("class").replace("category-best-unit","").trim()||"";this.categories.display.push(i)}),this)),this.orderingCategory(this.categories.display)},setElementPosition:function(){this.positions={menuMarginTop:10,bestAreaOffsetTop:this.elements.root.offset().top+parseInt(this.elements.menu.css("marginTop"))-10,startStayOffsetTop:this.elements.root.offset().top+this.elements.root.innerHeight()-this.elements.menu.outerHeight()-10,stayOffsetTop:this.elements.root.innerHeight()-this.elements.menu.outerHeight()-10,categoryBoxesPosition:[]},this.elements.categoryBoxList.each(e.proxy((function(t,n){this.positions.categoryBoxesPosition.push(e(n).offset().top-this.positions.menuMarginTop-t*this.elements.menuCategoryBtnList.eq(0).outerHeight())}),this))},setSettingLayerHeight:function(){e(window).height()<=740?this.elements.settingLayer.addClass("scroll-view"):this.elements.settingLayer.removeClass("scroll-view")},reset:function(e){this.setElementPosition(),this.activateCategoryButton(),"ordering"==e&&this.orderingCategory(this.categories._default,this.categories._default)},closeTooltip:function(){o.setCookie("hideCategoryBestTooltip",!0)},sendImpression:function(){if("undefined"==typeof CoupangWebLog)return!1;var t=this;e(this.elements.productLists).each((function(){var n=e(this).find(".prod-list .category-best__ad-badge a");if(n.length>0){var i=e(n[0]).data("logImpression");if(i){var o=i.id,a=m[o].meta;t.sendC3ImpressionLogData(i,a,n)}}var s=e(this).find(".prod-list .product-unit");if(s.length>0){var r=e(s[0]).data("logImpression");if(r){var c=m.impression_c3_product_listing_all.meta;t.sendC3ImpressionLogData(r,c,s)}}}))},sendC3ImpressionLogData:function(t,n,i){var o={meta:{},data:{},extra:{}};if(t){var a=t.id;o.data=e.extend({},o.data,{domain:"home",pageName:"home",logCategory:"impression",logType:"impression",eventName:a}),o.data=e.extend({},o.data,t.param),o.meta=e.extend({},o.meta,n);var s=[],r=[];i.each((function(){var t=e(this).data("logImpression");t&&t.detail&&(t.detail.productId&&""!==t.detail.productId&&s.push(t.detail.productId),t.detail.vendorItemId&&""!==t.detail.vendorItemId&&r.push(t.detail.vendorItemId))})),o.data=e.extend({},o.data,{productIdList:s.join(","),vendorItemIdList:r.join(",")}),CoupangWebLog.submit(o)}},bindEvent:function(){this.elements.settingLayer.find(".set-category-list").sortable({revert:!0}).disableSelection(),e(this.elements.promotions).each((function(){i.slide({slider:e(this),size:1,size1hide:!0,rolling:!0,speed:2e3})})),e(this.elements.productLists).each((function(){i.slide({slider:e(this),size:6,size1hide:!0})})),function(){var t=l.size();0===t&&(t=(l=e(".ad-badge")).size());t>0&&(g(),function(t){for(var n=0;n<t;n++){var i=new Image,o=e(l[n]);i.setAttribute("src",o.data("impressionUri"))}e(".category-best__ad-badge").each((function(t,n){new r(n,e(n).find(".ad-badge").data("viewImpression"))})),e(".prod-list").on("click",".category-best__ad-badge",(function(t){(new Image).setAttribute("src",e(t.currentTarget).find(".ad-badge").data("clickUri"))}))}(t))}(),this.elements.settingButton.click(e.proxy((function(){this.elements.settingLayerTail.css("top",this.elements.menu.innerHeight()-22),this.elements.settingLayer.is(":visible")&&this.orderingCategory(this.categories.display),this.elements.settingLayer.toggle()}),this)),this.elements.menuCategoryBtnList.click(e.proxy((function(t){t.preventDefault();var n=e(e(t.target).attr("href"));0!=n.size()&&e(window).scrollTop(n.offset().top)}),this)),e(".set-category-list").find("input").on("change",(function(){this.checked?e(this).next().css("opacity","1"):e(this).next().css("opacity","0.2")})),this.elements.settingLayer.find(".reset").click(e.proxy((function(e){e.preventDefault(),this.reset("ordering")}),this)),this.elements.settingLayer.find(".cancel").click(e.proxy((function(e){e.preventDefault(),this.orderingCategory(this.categories.display),this.elements.settingLayer.hide()}),this)),this.elements.settingLayer.find(".confirm").click(e.proxy((function(e){e.preventDefault(),this.submit()}),this)),this.elements.categoryBestLink.click((function(){d.execManualLogging({logCategory:"event",logType:"scroll",logLabel:"home",viewGrp:"categoryBestUnit"})})),e(window).scroll(e.proxy(this.scrollEvent,this)).trigger("scroll"),"B"===s.getAbTestOptionByKey("2491")&&e(window).on("resize",e.proxy(this.setSettingLayerHeight,this))},scrollEvent:function(){var e=this.positions,t=this.elements;e.startStayOffsetTop<t.win.scrollTop()?t.menu.addClass("stay").css({top:e.stayOffsetTop+"px","margin-top":e.menuMarginTop+"px"}).show():e.bestAreaOffsetTop<t.win.scrollTop()&&e.startStayOffsetTop>t.win.scrollTop()?t.menu.removeClass("stay").addClass("fixed").css({top:"","margin-top":e.menuMarginTop+"px"}).show():t.menu.removeClass("fixed stay").css({top:"","margin-top":"72px"}).hide(),this.activateCategoryButton()},activateCategoryButton:function(){for(var e=0,t=this.elements.win.scrollTop(),n=this.positions.categoryBoxesPosition,i=this.elements.menuCategoryBtnList,o=0;n.length>o;o++)n[o]<=t&&(e=o);i.removeClass("on").eq(e).addClass("on")},getCheckedCategory:function(){var t=[];return this.elements.settingCategoryListWrap.find("input:checked").each((function(){t.push(e(this).val())})),t},saveCategories:function(t){var n={categories:t};e.ajax({url:"/np/preference",type:"post",data:n,error:function(e){"timeout"!==e.statusText&&404!==e.status||console}})},submit:function(){g();var e=this.getCheckedCategory();if(0==e.length)return alert(Pacifik.formatMessage("coupang.web.4b4d66","최소 1개 카테고리를 선택해 주세요"));this.elements.root.data("categories",e.join(",")),this.elements.win.scrollTop(this.positions.bestAreaOffsetTop-20),this.saveCategories(e.join(",")),this.closeTooltip(),this.callBackFn.apply()}},p})),define(["jquery"],(function(e){return{redBadgeNum:0,allBadgeNum:0,$numberingSpan:null,run:function(t,n){t&&n&&(this.redBadgeNum=t,this.allBadgeNum=n),this.$numberingSpan=e("#productList").find(".best-prod-numbering"),0!==this.$numberingSpan.length&&(this._coloring(),this._numbering())},_numbering:function(){for(var e=this.$numberingSpan.find("em").slice(0,this.allBadgeNum),t=this.allBadgeNum,n=0;n<t;n++)e.eq(n).text(n+1)},_coloring:function(){this.$numberingSpan.slice(0,this.redBadgeNum).addClass("best10"),this.$numberingSpan.slice(this.redBadgeNum,this.allBadgeNum).addClass("best30")}}})),define("countdown",["jquery"],(function(){function e(e){if(!e.startTime||!e.endTime)throw new Error("Please enter startTime and endTime");if(e.startTime>=e.endTime)throw new Error("endTime must be greater than startTime");if(e.onRender&&"function"!=typeof e.onRender)throw new Error("onRender must be a function");if(e.onComplete&&"function"!=typeof e.onComplete)throw new Error("onRender must be a function");this.startTime=e.startTime,this.endTime=e.endTime,this.onRender=e.onRender,this.onComplete=e.onComplete,this.interval=e.interval||1e3,this.timer=null,this.start()}return e.prototype={start:function(){var e=this,t=function(t){t&&(e.startTime=e.startTime+t);var n=e.endTime-e.startTime,i=Math.floor(n/864e5),o=Math.floor(n%864e5/36e5),a=Math.floor(n%36e5/6e4),s=Math.floor(n%6e4/1e3);if(n<0)return e.stop(),void(e.onComplete&&e.onComplete());e.onRender&&e.onRender({days:i,hours:o,minutes:a,seconds:s})};t(),this.timer=setInterval((function(){t(e.interval)}),this.interval)},stop:function(){this.timer&&clearInterval(this.timer)}},e})),define("couponExpirationReminder",["jquery","lodash"],(function(e,t){return{init:function(){this.fetchData()},fetchData:function(){var t=this;e.ajax({url:"/np/home/lapse-promotion-widget",dataType:"json"}).success((function(e){try{t.handleResponseData(e)}catch(e){}})).fail((function(){}))},handleResponseData:function(t){this.checkExist(t)&&this.renderGwWidget(e("#couponExpirationReminder"),t)},renderGwWidget:function(n,i){var o,a,s,r;o=n,a=i,s=function(e,t){window.CoupangWebLog&&window.CoupangWebLog.submit({meta:e,data:t})},r=function(e){if(e&&Array.isArray(e)&&e.length>0)for(var n=0;n<e.length;n++){var i=e[n],o={schemaId:t.get(i,"id"),schemaVersion:t.get(i,"version"),eventName:t.get(i,"name")};s(o,t.get(i,"mandatory"))}},coupangWebRequire(["common/components/dist/coupang-expiration"],(function(n){o.on("coupang-expiration-carousel.impression",(function(e){var n=t.get(a,"entity.logging.bypass.exposureSchema"),i=t.get(n,"mandatory"),o={schemaId:t.get(n,"id"),schemaVersion:t.get(n,"version"),eventName:t.get(n,"name")};s(o,i)})),o.on("coupang-expiration-carousel.item.click",(function(n){var i=e(n.target).data("index"),o=t.get(a,["entity","productEntities",i,"logging","bypass","clickSchemas"])||[];r(o)})),o.on("coupang-expiration-carousel.cart.click",(function(n){var i=e(n.target).data("index"),o=t.get(a,["entity","productEntities",i,"addToCartInfo","logging","bypass","clickSchemas"])||[];r(o)})),new n(o,{pageSize:5,step:1}).render(a)}))},checkExist:function(e){return!!e&&!(!e||0===e.length)}}})),define("criteoLog",["jquery"],(function(e){return{init:function(){window.dataLayer=window.dataLayer||[],window.dataLayer.push({PageType:"HomePage"})}}})),define("disagreeRegainFeeChangePopup",["jquery","lodash","moment","handlebars"],(function(e,t,n,i){var o,a=e("#disagreeRegainFeeChangePopup"),s=a.data(),r=!1;function c(){e("html").css("overflow-y","scroll")}function d(t){r||(r=!0,e.ajax({url:"/vp/notice/wow-fee-change/agreement",type:"POST",cache:!1,data:{agreed:"agree"===t},success:function(e){e.result?(l(t,!0),c(),a.remove()):(l(t,!1),c(),a.remove()),r=!1},error:function(){l(t,!1),c(),a.remove(),r=!1}}))}function l(e,t){var i={domain:"home",pageName:"home",eventName:"click_home_wow_consent_1st_popup",logCategory:"event",logType:"click",clickType:e,effectiveDate:n(s.disagreeRegainFeeChangePopup.effectiveDateTimestamp).format("YYYY-MM-DD"),isBudExposed:"n"};t?i.isSubmitSuceed="y":!1===t&&(i.isSubmitSuceed="n"),u({meta:{schemaId:8871,schemaVersion:2},data:i})}function u(e){CoupangWebLog&&CoupangWebLog.submit(e)}return{initialize:function(){a.length&&coupangWebRequire(["text!template/loyalty/regain/disagreeRegainFeeChangePopup.html"],(function(t){var n=i.compile(t),r=e(n(s));a.show(),a.html(r),e(window).off("message").on("message",(function(t){var n,i=t.originalEvent.data;try{n=e.isPlainObject(i)&&i.type?i:JSON.parse(i)}catch(e){n={type:i}}"frame.close"===n.type&&o&&(o.close(),o=null)})),e("#regain-agree-button").on("click",(function(){d("agree")})),e("#regain-disagree-button").on("click",(function(){d("disagree")})),e("#wow-membership-tnc").on("click",(function(){l("tnc"),o=window.open("https://loyalty.coupang.com/loyalty/sign-up/agreement/index","tncPopup","left=100,top=100,width=404,height=697")})),e("html").css("overflow-y","hidden"),u({meta:{schemaId:8870,schemaVersion:1},data:{domain:"home",pageName:"home",eventName:"impression_home_wow_consent_1st_popup",logCategory:"impression",logType:"impression",isBudExposed:"n"}})}))}}})),define("disagreeRegainFeeChangeSecondPopup",["jquery","lodash","moment","countdown","handlebars"],(function(e,t,n,i,o){var a,s,r=e("#disagreeRegainFeeChangeSecondPopup"),c=r.data(),d=!1;function l(t,n){d||e.ajax({url:"/vp/notice/wow-fee-change/agreement",type:"POST",cache:!1,data:{agreed:"agree"===t},beforeSend:function(){d=!0},success:function(e){e.result||alert(Pacifik.formatMessage("coupang.web.regain.date.expire","지금은 동의 여부를 선택할 수 없습니다.\n월회비 변경에 대해 동의하지 않기로 유지됩니다.")),n.success&&n.success(e)},error:function(){alert(Pacifik.formatMessage("coupang.web.regain.date.expire","지금은 동의 여부를 선택할 수 없습니다.\n월회비 변경에 대해 동의하지 않기로 유지됩니다.")),n.error&&n.error()},complete:function(){d=!1,e("html").css("overflow-y","scroll"),r.remove()}})}function u(t){var i={domain:"home",pageName:"home",eventName:t.data.eventName,logCategory:"event",logType:"click",clickType:t.data.clickType,type:"regain_2nd_pop_up",effectiveDate:n(c.secondDisagreeRegainFeeChangePopup.effectiveDateTimestamp).format("YYYY-MM-DD")},o=e(".benefits-popup-bud"),a=o.data("budAmount");o.length?(i.isBudExposed="y",i.budAmount=a):i.isBudExposed="n",t.data.isSubmitSuceed?i.isSubmitSuceed="y":!1===t.data.isSubmitSuceed&&(i.isSubmitSuceed="n"),p({meta:t.meta,data:i})}function m(t){var n={domain:"home",pageName:"home",eventName:t.data.eventName,logCategory:"impression",logType:"impression",type:"regain_2nd_pop_up"},i=e(".benefits-popup-bud"),o=i.data("budAmount");i.length?(n.isBudExposed="y",n.budAmount=o):n.isBudExposed="n",p({meta:t.meta,data:n})}function p(e){CoupangWebLog&&CoupangWebLog.submit(e)}function g(e){return 1===e.toString().length?"0"+e:e}return{initialize:function(){r.length&&coupangWebRequire(["text!template/loyalty/regain/disagreeRegainFeeChangeSecondPopup.html"],(function(t){var n=o.compile(t),d=e(n(c));r.show(),r.html(d),function(){var t=e(".regain-v2-countdown"),n=e("#regain-countdown");try{s=new i({startTime:c.secondDisagreeRegainFeeChangePopup.startTime,endTime:c.secondDisagreeRegainFeeChangePopup.endTime,onRender:function(e){var i=e.days>0?e.days+"일 ":"",o=g(e.hours)+":"+g(e.minutes)+":"+g(e.seconds);n.html(i+o),"visible"!==t.css("visibility")&&t.css("visibility","visible")},onComplete:function(){s.stop(),r.remove()}})}catch(e){}}(),e(window).off("message").on("message",(function(t){var n,i=t.originalEvent.data;try{n=e.isPlainObject(i)&&i.type?i:JSON.parse(i)}catch(e){n={type:i}}"frame.close"===n.type&&a&&(a.close(),a=null)})),e("#regain-second-popup-agree-button").on("click",(function(){l("agree",{success:function(){u({meta:{schemaId:8871,schemaVersion:4},data:{eventName:"click_home_wow_consent_1st_popup",clickType:"agree",isSubmitSuceed:!0}})},error:function(){u({meta:{schemaId:8871,schemaVersion:4},data:{eventName:"click_home_wow_consent_1st_popup",clickType:"disagree",isSubmitSuceed:!1}})}})})),e("#regain-second-popup-disagree-button").on("click",(function(){u({meta:{schemaId:8871,schemaVersion:4},data:{eventName:"click_home_wow_consent_1st_popup",clickType:"disagree",isSubmitSuceed:!1}}),coupangWebRequire(["text!template/loyalty/regain/disagreeRegainBenefitPopup.html"],(function(t){var n=o.compile(t),i=e(n(c));r.html(i),s&&s.stop(),e("#regain-second-agree-button").on("click",(function(){l("agree",{success:function(){u({meta:{schemaId:8873,schemaVersion:2},data:{eventName:"click_home_wow_consent_2nd_popup",clickType:"agree",isSubmitSuceed:!0}})},error:function(){u({meta:{schemaId:8873,schemaVersion:2},data:{eventName:"click_home_wow_consent_2nd_popup",clickType:"disagree",isSubmitSuceed:!1}})}})})),e("#regain-second-disagree-button").on("click",(function(){l("disagree",{success:function(){u({meta:{schemaId:8873,schemaVersion:2},data:{eventName:"click_home_wow_consent_2nd_popup",clickType:"disagree",isSubmitSuceed:!0}})},error:function(){u({meta:{schemaId:8873,schemaVersion:2},data:{eventName:"click_home_wow_consent_2nd_popup",clickType:"disagree",isSubmitSuceed:!1}})}})})),e("#regain-second-tnc-button").on("click",(function(){u({meta:{schemaId:8873,schemaVersion:2},data:{eventName:"click_home_wow_consent_2nd_popup",clickType:"tnc"}}),a=window.open("https://loyalty.coupang.com/loyalty/sign-up/agreement/index","tncPopup","left=100,top=100,width=404,height=697")})),m({meta:{schemaId:8872,schemaVersion:2},data:{eventName:"impression_home_wow_consent_2nd_popup"}})}))})),e("#regain-second-tnc").on("click",(function(){u({meta:{schemaId:8871,schemaVersion:4},data:{eventName:"click_home_wow_consent_1st_popup",clickType:"tnc"}}),a=window.open("https://loyalty.coupang.com/loyalty/sign-up/agreement/index","tncPopup","left=100,top=100,width=404,height=697")})),e("html").css("overflow-y","hidden"),m({meta:{schemaId:8870,schemaVersion:3},data:{eventName:"impression_home_wow_consent_1st_popup"}})}))}}})),define("disagreeRegainFeeChangeThirdPopup",["jquery","lodash","moment","countdown","handlebars"],(function(e,t,n,i,o){var a,s,r=e("#disagreeRegainFeeChangeThirdPopup"),c=r.data(),d=!1;function l(t,n){d||e.ajax({url:"/vp/notice/wow-fee-change/agreement",type:"POST",cache:!1,data:{agreed:"agree"===t},beforeSend:function(){d=!0},success:function(e){e.result||alert(Pacifik.formatMessage("coupang.web.regain.date.expire","지금은 동의 여부를 선택할 수 없습니다.\n월회비 변경에 대해 동의하지 않기로 유지됩니다.")),n.success&&n.success(e)},error:function(){alert(Pacifik.formatMessage("coupang.web.regain.date.expire","지금은 동의 여부를 선택할 수 없습니다.\n월회비 변경에 대해 동의하지 않기로 유지됩니다.")),n.error&&n.error()},complete:function(){d=!1,u(),r.remove()}})}function u(){e("html").css("overflow-y","scroll")}function m(t){var i={domain:"home",pageName:"home",eventName:t.data.eventName,logCategory:"event",logType:"click",clickType:t.data.clickType,type:"regain_3rd_pop_up",effectiveDate:n(c.thirdDisagreeRegainFeeChangePopup.effectiveDateTimestamp).format("YYYY-MM-DD")},o=e(".benefits-popup-bud"),a=o.data("budAmount");o.length?(i.isBudExposed="y",i.budAmount=a):i.isBudExposed="n",t.data.isSubmitSuceed?i.isSubmitSuceed="y":!1===t.data.isSubmitSuceed&&(i.isSubmitSuceed="n"),g({meta:t.meta,data:i})}function p(t){var n={domain:"home",pageName:"home",eventName:t.data.eventName,logCategory:"impression",logType:"impression",type:"regain_3rd_pop_up"},i=e(".benefits-popup-bud"),o=i.data("budAmount");i.length?(n.isBudExposed="y",n.budAmount=o):n.isBudExposed="n",g({meta:t.meta,data:n})}function g(e){CoupangWebLog&&CoupangWebLog.submit(e)}function h(e){return 1===e.toString().length?"0"+e:e}return{initialize:function(){r.length&&coupangWebRequire(["text!template/loyalty/regain/disagreeRegainFeeChangeThirdPopup.html"],(function(t){var n=o.compile(t),g=e(n(c));r.show(),r.html(g),function(){var t=e(".regain-v3-countdown"),n=e("#regain-countdown");try{s=new i({startTime:c.thirdDisagreeRegainFeeChangePopup.startTime,endTime:c.thirdDisagreeRegainFeeChangePopup.endTime,onRender:function(e){var i='<span class="countdown-days">'+(e.days>0?e.days+'<span class="countdown-day-text">'+Pacifik.formatMessage("coupang.web.consent.third.regain.countdown.day","일")+"</span>":"")+"</span>";i+="B"===c.thirdDisagreeRegainFeeChangePopup.abTest&&e.days>0?'<span class="countdown-colon">:</span>':"",i+='<span class="countdown-hours">'+h(e.hours)+"</span>",i+='<span class="countdown-colon">:</span>',i+='<span class="countdown-minutes">'+h(e.minutes)+"</span>",i+='<span class="countdown-colon">:</span>',i+='<span class="countdown-seconds">'+h(e.seconds)+"</span>",n.html(i),"visible"!==t.css("visibility")&&t.css("visibility","visible")},onComplete:function(){s.stop(),u(),r.remove()}})}catch(e){}}(),e(window).off("message").on("message",(function(t){var n,i=t.originalEvent.data;try{n=e.isPlainObject(i)&&i.type?i:JSON.parse(i)}catch(e){n={type:i}}"frame.close"===n.type&&a&&(a.close(),a=null)})),e("#loyalty-fee-change-agree-button").on("click",(function(){l("agree",{success:function(){m({meta:{schemaId:8871,schemaVersion:4},data:{eventName:"click_home_wow_consent_1st_popup",clickType:"agree",isSubmitSuceed:!0}})},error:function(){m({meta:{schemaId:8871,schemaVersion:4},data:{eventName:"click_home_wow_consent_1st_popup",clickType:"agree",isSubmitSuceed:!1}})}})})),e("#loyalty-fee-change-disagree-button").on("click",(function(){d||(m({meta:{schemaId:8871,schemaVersion:4},data:{eventName:"click_home_wow_consent_1st_popup",clickType:"disagree",isSubmitSuceed:!1}}),coupangWebRequire(["text!template/loyalty/regain/disagreeRegainBenefitThirdPopup.html"],(function(t){var n=o.compile(t),i=e(n(c));r.html(i),s&&s.stop(),e("#regain-third-agree-button").on("click",(function(){l("agree",{success:function(){m({meta:{schemaId:8873,schemaVersion:2},data:{eventName:"click_home_wow_consent_2nd_popup",clickType:"agree",isSubmitSuceed:!0}})},error:function(){m({meta:{schemaId:8873,schemaVersion:2},data:{eventName:"click_home_wow_consent_2nd_popup",clickType:"agree",isSubmitSuceed:!1}})}})})),e("#regain-third-disagree-button").on("click",(function(){l("disagree",{success:function(){m({meta:{schemaId:8873,schemaVersion:2},data:{eventName:"click_home_wow_consent_2nd_popup",clickType:"disagree",isSubmitSuceed:!0}})},error:function(){m({meta:{schemaId:8873,schemaVersion:2},data:{eventName:"click_home_wow_consent_2nd_popup",clickType:"disagree",isSubmitSuceed:!1}})}})})),e("#regain-third-tnc-button").on("click",(function(){d||(m({meta:{schemaId:8873,schemaVersion:2},data:{eventName:"click_home_wow_consent_2nd_popup",clickType:"tnc"}}),a=window.open("https://loyalty.coupang.com/loyalty/sign-up/agreement/index","tncPopup","left=100,top=100,width=404,height=697"))})),p({meta:{schemaId:8872,schemaVersion:2},data:{eventName:"impression_home_wow_consent_2nd_popup"}})})))})),e("#loyalty-fee-change-footer-expand-button").on("click",(function(){e(".loyalty-fee-change-contents__footer-container").toggleClass("expand")})),e("#loyalty-fee-change-show-tnc-button").on("click",(function(){d||(m({meta:{schemaId:8871,schemaVersion:4},data:{eventName:"click_home_wow_consent_1st_popup",clickType:"tnc"}}),a=window.open("https://loyalty.coupang.com/loyalty/sign-up/agreement/index","tncPopup","left=100,top=100,width=404,height=697"))})),e("html").css("overflow-y","hidden"),p({meta:{schemaId:8870,schemaVersion:3},data:{eventName:"impression_home_wow_consent_1st_popup"}})}))}}})),define("disagreeRegainPermanentPopup",["jquery","lodash","moment","countdown","common/utils/cookieUtils","handlebars"],(function(e,t,n,i,o,a){var s,r,c=e("#disagreePermanentBanner"),d=e("#disagreeRegainPermanentPopup"),l=c.data(),u=!1,m="hasPermanentBanner",p=[];function g(t,n){u||e.ajax({url:"/vp/notice/wow-fee-change/agreement",type:"POST",cache:!1,data:{agreed:"agree"===t},beforeSend:function(){u=!0},success:function(e){e.result||alert(Pacifik.formatMessage("coupang.web.regain.date.expire","지금은 동의 여부를 선택할 수 없습니다.\n월회비 변경에 대해 동의하지 않기로 유지됩니다.")),n.success&&n.success(e)},error:function(){alert(Pacifik.formatMessage("coupang.web.regain.date.expire","지금은 동의 여부를 선택할 수 없습니다.\n월회비 변경에 대해 동의하지 않기로 유지됩니다.")),n.error&&n.error()},complete:function(){u=!1,e("html").css("overflow-y","scroll"),r.stop(),d.remove(),c.remove()}})}function h(t){var n=e.extend({domain:"home",pageName:"home",eventName:t.data.eventName,logCategory:"event",logType:"click",clickType:t.data.clickType},t.data);y({meta:t.meta,data:n})}function f(t){var n=e.extend({domain:"home",pageName:"home",eventName:t.data.eventName,logCategory:"impression",logType:"impression"},t.data);y({meta:t.meta,data:n})}function y(e){CoupangWebLog&&CoupangWebLog.submit(e)}function w(e){return 1===e.toString().length?"0"+e:e}return{initialize:function(){c.length&&"Y"!==o.getValue(m)&&coupangWebRequire(["text!template/loyalty/regain/disagreeRegainPermanentCount.html"],(function(t){var u,y=a.compile(t);c.html(e(y(l))).show(),e("#permanent-time").on("click",(function(){coupangWebRequire(["text!template/loyalty/regain/disagreeRegainPermanentPopup.html"],(function(t){var i,o,r=a.compile(t);d.html(e(r(l))).show(),i=e("#regain-permanent-countdown"),o=e(".regain-v2-countdown"),p.push((function(e){var t=e.days>0?e.days+"일 ":"",n=w(e.hours)+":"+w(e.minutes)+":"+w(e.seconds);i.html(t+n),"visible"!==o.css("visibility")&&o.css("visibility","visible")})),e(window).off("message").on("message",(function(t){var n,i=t.originalEvent.data;try{n=e.isPlainObject(i)&&i.type?i:JSON.parse(i)}catch(e){n={type:i}}"frame.close"===n.type&&s&&(s.close(),s=null)})),e("#regain-permanent-popup-agree-button").on("click",(function(){g("agree",{success:function(){h({meta:{schemaId:8871,schemaVersion:4},data:{eventName:"click_home_wow_consent_1st_popup",clickType:"agree",type:"regain_permanent",isSubmitSuceed:"y",effectiveDate:n(l.thirdDisagreeRegainPermanentBanner.effectiveDateTimestamp).format("YYYY-MM-DD"),isBudExposed:"n",budAmount:null}})},error:function(){h({meta:{schemaId:8871,schemaVersion:4},data:{eventName:"click_home_wow_consent_1st_popup",clickType:"disagree",type:"regain_permanent",isSubmitSuceed:"n",effectiveDate:n(l.thirdDisagreeRegainPermanentBanner.effectiveDateTimestamp).format("YYYY-MM-DD"),isBudExposed:"n",budAmount:null}})}})})),e("#regain-permanent-popup-disagree-button").on("click",(function(){g("disagree",{success:function(){h({meta:{schemaId:8871,schemaVersion:4},data:{eventName:"click_home_wow_consent_1st_popup",clickType:"disagree",type:"regain_permanent",isSubmitSuceed:"y",effectiveDate:n(l.thirdDisagreeRegainPermanentBanner.effectiveDateTimestamp).format("YYYY-MM-DD"),isBudExposed:"n",budAmount:null}})},error:function(){h({meta:{schemaId:8871,schemaVersion:4},data:{eventName:"click_home_wow_consent_1st_popup",clickType:"disagree",type:"regain_permanent",isSubmitSuceed:"n",effectiveDate:n(l.thirdDisagreeRegainPermanentBanner.effectiveDateTimestamp).format("YYYY-MM-DD"),isBudExposed:"n",budAmount:null}})}})})),e("#regain-permanent-tnc").on("click",(function(){h({meta:{schemaId:8871,schemaVersion:4},data:{eventName:"click_home_wow_consent_1st_popup",clickType:"tnc",type:"regain_permanent",isBudExposed:"n",budAmount:null}}),s=window.open("https://loyalty.coupang.com/loyalty/sign-up/agreement/index","tncPopup","left=100,top=100,width=404,height=697")})),e("html").css("overflow-y","hidden"),f({meta:{schemaId:8870,schemaVersion:3},data:{eventName:"impression_home_wow_consent_1st_popup",type:"regain_permanent",isBudExposed:"n",budAmount:null}})})),h({meta:{schemaId:9357,schemaVersion:1},data:{eventName:"click_home_wow_consent_regain_permanent_popup",clickType:"seemore"}})})),e("#permanent-banner-close").on("click",(function(){o.getValue(m)||o.setCookie(m,"Y",{timeUnit:"DAY",timeValue:3}),c.remove(),h({meta:{schemaId:9357,schemaVersion:1},data:{eventName:"click_home_wow_consent_regain_permanent_popup",clickType:"close"}})})),u=e("#permanent-countdown"),p.push((function(e){var t=e.days>0?e.days+"일 ":"",n='<span class="countdown__number">'+w(e.hours)+'</span>:<span class="countdown__number">'+w(e.minutes)+'</span>:<span class="countdown__number">'+w(e.seconds)+"</span>";u.html(t+n)})),function(){try{r=new i({startTime:l.thirdDisagreeRegainPermanentBanner.startTime,endTime:l.thirdDisagreeRegainPermanentBanner.endTime,onRender:function(e){if(p.length)for(var t=0;t<p.length;t++)p[t](e)},onComplete:function(){r.stop(),c.remove(),d.remove()}})}catch(e){}}(),f({meta:{schemaId:9356,schemaVersion:1},data:{eventName:"impression_home_wow_consent_regain_permanent_popup"}})}))}}})),define("homeContentUnit",["jquery","common/template/urlBuilder","home/rocketBadge","common/essentialData"],(function(e,t,n,i){"use strict";var o="basepreviewmode",a="baseshowdatetime",s="basesegmentid",r="basemembersrl",c=function(){return 1==e("#"+o).data(o)},d=function(){return e("#"+a).data(a)},l=function(){return e("#"+s).data(s)},u=function(){return e("#"+r).data(r)};return{init:function(e,t,n,i){var o={target:e,unit:t,duplicateProductIds:n,callback:i,sort:!1,showDateTime:null,segmentId:l(),memberSrl:u()};c()&&(o.showDateTime=d()),this.async(o)},async:function(o){e.ajax({url:t.buildRequestUrl("/np/home/unit/"+o.unit),type:"GET",data:{duplicateProductIds:o.duplicateProductIds,sort:o.sort,segmentId:o.segmentId,showDateTime:o.showDateTime,memberSrl:o.memberSrl},dataType:"HTML",success:function(e){o.target.html(e),o.callback&&o.callback(),"B"===i.getAbTestOptionByKey("2449")&&""!==e&&new n(o.target),o.target.find(".main-section").outerHeight()<=0&&o.target.remove()},error:function(e){"timeout"!==e.statusText&&404!==e.status||procMng.hideIndicator()}})}}})),define("homeRightSideBar",["jquery","common/essentialData","common/adsplatform/ViewableImpressionLogger","weblog","HomeWebLogger","commonUtils"],(function(e,t,n,i,o,a){var s=function(t,n){if(t&&(this.$container=e(t),this.$container.length)){this.options=e.extend({},{stickRefSelector:"",departRefSelector:""},n),this.init(this.options)}};s.prototype.init=function(){window.CoupangWebLog||i.init({platform:"web",service:"coupang",mode:""===t.getProfile()||"production"===t.getProfile()?"production":"test",useAutoSendPageViewLog:!1}),this.bindEvent()},s.prototype.bindEvent=function(){this.$container.data("is-stick")&&this.bindStickOnScroll(),this.bindImpression(),this.bindAdsBannerClick(),this.bindGoTopBtnClick(),this.loadCmgComponent()},s.prototype.bindImpression=function(){var t=this;t.$container.find(".ads-line-banner-container .ads-line-banner-list li>a").each((function(t,i){r("impression",e(i).data("adsplatform").impressionLogUri),new n(i)}));var i=function(){var n=t.$container.get(0).getBoundingClientRect();n.top>=0&&n.top<=e(window).height()&&(t.$container.hasClass("viewed")||(t.$container.addClass("viewed"),t.$container.find(".ads-line-banner-container .ads-line-banner-list li>a").each((function(e,n){c(t.getImpressionLoggingData())})),e(window).off("scroll",i)))};e(window).on("scroll",i)},s.prototype.bindGoTopBtnClick=function(){var t=this;e(".side-button #sideTop").on("click",(function(){t.$container.removeClass("stick").css("top",0)}))},s.prototype.bindAdsBannerClick=function(){var t=this;this.$container.on("click",".ads-line-banner-container .ads-line-banner-link",(function(n){var i=e(n.currentTarget);r("click",i.data("adsplatform").clickLogUri),d(t.getClickLoggingData(i))}))},s.prototype.bindStickOnScroll=function(){var t=this,n=t.$container.offsetParent(),i=t.options.stickRefSelector?e(t.options.stickRefSelector):t.$container,o=t.options.departRefSelector?e(t.options.departRefSelector):"",a=parseInt(i.css("padding-top")),s=function(){return t.$container.hasClass("stick")};e(window).on("scroll",(function(){if(i.get(0).getBoundingClientRect().top+a<0)if(o.length&&o.get(0).getBoundingClientRect().top<=t.$container.get(0).getBoundingClientRect().bottom)if(s()){t.$container.removeClass("stick");var e=-n.get(0).getBoundingClientRect().top;t.$container.css("top",e);var r=t.$container.get(0).getBoundingClientRect().bottom-o.get(0).getBoundingClientRect().top;r>0&&t.$container.css("top",e-r)}else t.$container.get(0).getBoundingClientRect().top>0&&t.$container.height()<o.get(0).getBoundingClientRect().top&&(t.$container.addClass("stick"),t.$container.css("top",0));else!s()&&t.$container.height()<o.get(0).getBoundingClientRect().top&&(t.$container.addClass("stick"),t.$container.css("top",0));else s()&&(t.$container.removeClass("stick"),t.$container.css("top",0))}))},s.prototype.getImpressionLoggingData=function(){var t=this.$container.find(".ads-line-banner-list li>a"),n=a.getUrlParameters(t.eq(0).attr("href")),i=t.eq(0).data("ad-id"),o=[];return t.each((function(t,n){var i=e(n).data("vendor-item-id");o.push(i)})),{adId:i+"",sourceType:n&&n.sourceType||"",vendorItemList:o.join()}},s.prototype.getClickLoggingData=function(e){var t=a.getUrlParameters(e.attr("href")),n=e.data("ad-id"),i=e.data("product-id"),o=e.data("vendor-item-id"),s=e.data("item-id");return{adId:n+"",sourceType:t&&t.sourceType||"",productId:i+"",vendorItemId:o+"",itemId:s+""}},s.prototype.loadCmgComponent=function(){coupangWebRequire(["cmgComponents/dist/pcRightWingBanner"],(function(e){e()}))};var r=function(e,t){try{return(new Image).src=t,!0}catch(e){return!1}},c=function(e){o.impressionLog({id:"impression_product_ad_line_widget",param:e})},d=function(e){o.clickLogWithoutEventParam({id:"click_product_ad_line_banner",param:e})};return s})),define("homeRollingBanner",["jquery","common/essentialData","weblog","HomeWebLogger"],(function(e,t,n,i){var o=function(e,t,n,i){this.init(e,t,n,i)};return o.prototype={loggingFlag:!1,init:function(i,o,a,s){window.CoupangWebLog||n.init({platform:"web",service:"coupang",mode:""===t.getProfile()||"production"===t.getProfile()?"production":"test",useAutoSendPageViewLog:!1}),this.rollingBanner({indicator:i,slider:e(o),speed:s,activatedClass:a})},rollingBanner:function(t){var n=(t=e.extend({slider:null,speed:"1000",activatedClass:null,indicator:null},t)).slider,o=n.find("ul").find("li"),a="",s=t.speed,r=n.find("ol"),c=n.find(".move"),d=Math.ceil(o.size()/1),l=0,u=[],m=t.indicator,p=t.activatedClass,g=function(){if(o.length<1)return!1;var t=e(window),i=n.offset().top;return i+n.height()>t.scrollTop()&&i<t.scrollTop()+t.height()},h=g();e(window).on("scroll",e.proxy((function(){g()?!1===h&&(h=!0,f()):h=!1}),this));var f=function(){if(o.length>0&&u.length<o.length){var t=m+" ."+p,n=e(t).find("a").data("logProps"),i=e(t).data("bannerId");n&&u.indexOf(i)<0&&!0===h&&(y(n),u.push(i))}},y=function(e){i.impressionLog({id:e.impressionId,param:e.param},{isAsync:!0})},w=function(){e(o).hide(),o.removeClass(p),e(o).each((function(){var t=e(this);Math.floor(t.index()/1)==l?(t.show(),t.addClass(p)):(t.hide(),t.removeClass(p))})),f()},v=function(){r.find("li").removeClass("selected"),r.find("li").eq(l).addClass("selected")},b=function(e){"next"==e?++l>d-1&&(l=0):--l<0&&(l=d-1),v(),w()},_=function(e){"start"==e?a=setInterval((function(){b("next")}),s):clearInterval(a)};n.bind({mouseenter:function(){_("stop")},mouseleave:function(){_("start")}}),_("start");c.unbind("click").bind("click",(function(t){t.preventDefault(),e(this).hasClass("next")?b("next"):b("prev"),v(),w()})),function(){if(1===o.size())c.hide(),r.hide();else{r.html("");for(var t=0;t<d;t++)r.append('<li><a title="'+(t+1)+'">'+(t+1)+"</a></li>");r.find("li").each((function(){e(this).on("click",(function(){l=e(this).index(),v(),w()}))})),v()}w()}()}},o})),define("homeUnit",["jquery","common/template/urlBuilder","home/rocketBadge","common/essentialData","common/adsplatform/adsplatformLogger","home/categoryBestBanner","home/homeRollingBanner"],(function(e,t,n,i,o,a,s){"use strict";return{init:function(e,t,n,i,o){this.ajaxCall({target:e,unit:t,duplicateProductIds:n,callback:i,extraParam:o})},ajaxCall:function(s){var r={target:null,unit:null,duplicateProductIds:null,callback:null,sort:!1};r=e.extend(r,s),e.ajax({url:t.buildRequestUrl("/np/homeunit/"+r.unit),type:"post",data:e.extend({duplicateProductIds:r.duplicateProductIds,sort:r.sort},r.extraParam),dataType:"HTML",success:function(t){(r.target.html(t),r.callback&&r.callback(),"BEST_CATEGORY"===r.unit&&(new o(e(".promotion li"),!1),new o(e(".category-best-banner"),!1),new a),"B"===i.getAbTestOptionByKey("2449"))&&("BEST_CATEGORY"===r.unit?e(".category-best-unit").each((function(t,i){new n(e(i))})):""!==t&&new n(r.target));if("BEST_CATEGORY"!==r.unit){var s=r.target.find(".main-section").outerHeight();s>0?r.target.css("height",s):r.target.remove()}},beforeSend:function(){"BEST_CATEGORY"===r.unit&&r.target.html('<div class="loading-noti-area"><p class="loading-noti">Loading...</p></div>')},error:function(e){"timeout"!==e.statusText&&404!==e.status||procMng.hideIndicator()}})}}})),define("HomeWebLogSchemas",["jquery"],(function(e){"use strict";return{BASE_LOG_PARAMS:{impression_ad:{meta:{schemaId:60,schemaVersion:2},data:{domain:"list",pageName:"list"}},click_rolling_item:{meta:{schemaId:62,schemaVersion:2},data:{domain:"list",pageName:"list"}},click_home_product:{meta:{schemaId:1191,schemaVersion:4}},click_home_product_navigation:{meta:{schemaId:1192,schemaVersion:1}},click_home_rolling_banner_navigation:{meta:{schemaId:1199,schemaVersion:1}}},LOG_PARAMS:{impression_home_todayshot:{meta:{schemaId:1187,schemaVersion:1}},click_home_todays_discovery:{meta:{schemaId:1189,schemaVersion:1},data:{eventGroup:"TodaysDiscovery"}},click_home_yourcartproduct_more:{meta:{schemaId:1190,schemaVersion:1}},click_home_best_category_icon:{meta:{schemaId:1193,schemaVersion:1}},click_home_best_category_setting:{meta:{schemaId:1196,schemaVersion:1}},click_home_best_category_quicklink:{meta:{schemaId:1197,schemaVersion:1},data:{eventGroup:"best_category",contentType:"quicklink"}},click_home_best_category_hotkeyword:{meta:{schemaId:1198,schemaVersion:1},data:{eventGroup:"best_category",contentType:"hotkeyword"}},impression_personalized_gw:{meta:{schemaId:1431,schemaVersion:5}},click_personalized_gw:{meta:{schemaId:1435,schemaVersion:4}},impression_line_banner:{meta:{schemaId:2612,schemaVersion:1}},click_line_banner:{meta:{schemaId:2613,schemaVersion:1}},impression_home_rolling_line_banner:{meta:{schemaId:60,schemaVersion:3},data:{domain:"list",pageName:"list",eventName:"impression_ad"}},click_home_rolling_line_banner:{meta:{schemaId:62,schemaVersion:4},data:{domain:"list",pageName:"list",eventName:"click_rolling_item"}},web_latency_track_log:{meta:{schemaId:2317,schemaVersion:2}},impression_product_ad_line_widget:{meta:{schemaId:2914,schemaVersion:2,eventName:"impression_product_ad_line_widget"}},click_product_ad_line_banner:{meta:{schemaId:2915,schemaVersion:2,eventName:"click_product_ad_line_banner"}},impression_c3_product_listing:{meta:{schemaId:3150,schemaVersion:4}},impression_c3_product_listing_all:{meta:{schemaId:10198,schemaVersion:1}},home_pii_noti_impression:{meta:{schemaId:7553,schemaVersion:1},data:{eventName:"impression_home_pii_noti"}},home_pii_noti_click:{meta:{schemaId:7554,schemaVersion:1},data:{eventName:"click_home_pii_noti"}}}}})),define("HomeWebLogger",["jquery","home/home","common/essentialData"],(function(e,t,n){"use strict";var i="click",o={page:"view",impression:"impression",click:"event",scroll:"event",latency:"etc"},a={},s={};coupangWebRequire(["HomeWebLogSchemas"],(function(t){a=e.extend(a,t.BASE_LOG_PARAMS),s=e.extend(a,t.LOG_PARAMS)}));var r={bindClickLogEventHandler:function(){e("#contents.home, #todaysHot.main-today").on("click","[data-log-props]",(function(e){r.clickLog(e)}))},makeLogParam:function(t,n){if(!1===n.hasOwnProperty("id"))return!1;var a=n.id,r={meta:{},data:{},extra:{}},c=t||i,d=!1;return r.data=e.extend({},r.data,{domain:"home",pageName:"home",logCategory:o[c],logType:c,eventName:a}),!0===s.hasOwnProperty(a)&&(d=s[a].hasOwnProperty("data"),r.data=e.extend({},r.data,s[a].data),r.meta=e.extend({},r.meta,s[a].meta),d&&s[a].data.hasOwnProperty("domain")&&(r.data.domain=s[a].data.domain),d&&s[a].data.hasOwnProperty("pageName")&&(r.data.pageName=s[a].data.pageName)),!0===n.hasOwnProperty("param")&&(r.data=e.extend({},r.data,n.param),r.extra=e.extend({},r.extra,n.extra)),r},impressionLog:function(e,t){var n=this.makeLogParam("impression",e);this.submitLog(n,t)},clickLog:function(t){var n=e(t.currentTarget).attr("data-log-props"),o=this.makeLogParam(i,e.parseJSON(n));this.submitLog(o),t.stopPropagation()},clickLogWithoutEventParam:function(e){var t=this.makeLogParam("click",e);this.submitLog(t)},latencyTrackLog:function(t,n){var i=this.makeLogParam("latency",t);i.extra=e.extend({},i.extra,n),this.submitLog(i)},submitLog:function(e,t){return"B"===n.getAbTestOptionByKey("4250")&&("undefined"!=typeof CoupangWebLog&&(!1!==e.meta.hasOwnProperty("schemaId")&&(!1!==e.meta.hasOwnProperty("schemaVersion")&&void CoupangWebLog.submit(e,t))))}};return r})),define("personalizedGW",["jquery","handlebars","common/adsplatform/ViewableImpressionLogger","HomeWebLogger","ads-components/dist/carousel","common/abtest/ABTestHelper"],(function(e,t,n,i,o,a){var s="personalized_ads",r="trending_ads",c="decker-carousel",d="gw_promotion",l="jikgu_promotion";return{$widgetContainer:e("#personalizedGW"),impressionLogList:{},continuationToken:"",init:function(){this.fetchData(),this.initEvent()},fetchData:function(t){var n=this;e.ajax({url:"/np/recommend/feeds",dataType:"json",data:{nextFeedsToken:t}}).success((function(e){n.continuationToken=e.continuationToken;try{n.handleResponseData(e)}catch(e){}})).fail((function(){}))},handleResponseData:function(e){if(this.checkExist(e))for(var t=this.$widgetContainer,n=0,i=e.feeds;n<i.length;n++){var o=i[n],a=o.feedId,c=n===i.length-1,u=s===o.type,m=r===o.type,p=l===o.type;isGwPromotionWidget=d===o.type,o.isAds=o.productLists&&o.productLists.length&&o.productLists[0].ads,u||m?o&&o.productLists&&o.productLists.length>=3&&this.renderDeckerCarousel(t,a,o,c):isGwPromotionWidget?this.renderGwPromotionWidget(t,a,o,c):p?this.renderJikguPromotionWidget(t,a,o,c):this.renderWidget(t,a,o,c)}},renderDeckerCarousel:function(t,n,o,a){var d=this,l=e("<div/>",{id:n,class:o.type+" carousel-widget-container "+[].join(" ")}).data({"carousel-feed-type":o.type});s===o.type?l.prependTo(t):l.appendTo(t),t.addClass("full-width"),function(t,l){coupangWebRequire(["common/components/dist/decker-carousel"],(function(u){switch(d.checkWidgetInViewPort(n,o,a),t.on("decker-carousel.impression",(function(t){e(".carousel-widget-container."+l.type).trigger("carousel."+l.type+".visible"),d.impressionLogList[n]=l.impressionLogging||{};var i=d.impressionLogList[n];i.widgetType=c,i.numVisibleItems=t.unitCount})),t.on("decker-carousel.item.click",(function(t){var n=e(t.target).data("clickLogging")||{};n.widgetType=c,i.clickLogWithoutEventParam({id:"click_personalized_gw",param:n})})),t.on("decker-carousel.nav.click",(function(t){if(e(t.target).hasClass("next"))for(var i in d.impressionLogList){var o=d.impressionLogList[i];if(i===n){try{o.numVisibleItems=t.reachUnitCount}catch(e){}break}}})),l.type){case s:case r:new u(t,{pageSize:5,step:1}).render(l)}}))}(l,o)},renderGwPromotionWidget:function(t,n,o,a){var s=this,r=e("<div/>",{id:n,class:o.type+" carousel-widget-container "+[].join(" ")}).data({"carousel-feed-type":o.type});r.appendTo(t),t.addClass("full-width"),function(t,r){coupangWebRequire(["common/components/dist/promotion-widget"],(function(c){s.checkWidgetInViewPort(n,o,a),t.on("promotion-decker-carousel.impression",(function(t){e(".carousel-widget-container."+r.type).trigger("carousel."+r.type+".visible"),s.impressionLogList[n]=r.impressionLogging||{};var i=s.impressionLogList[n];i.widgetType=d,i.numVisibleItems=t.unitCount})),t.on("promotion-decker-carousel.item.click",(function(t){var n=e(t.target).data("clickLogging")||{};n.widgetType=d,i.clickLogWithoutEventParam({id:"click_personalized_gw",param:n})})),t.on("promotion-decker-carousel.nav.click",(function(t){if(e(t.target).hasClass("next"))for(var i in s.impressionLogList){var o=s.impressionLogList[i];if(i===n){try{o.numVisibleItems=t.reachUnitCount}catch(e){}break}}})),new c(t,{pageSize:5,step:1}).render(r)}))}(r,o)},renderJikguPromotionWidget:function(t,n,o,s){var r,c=this,d="51291",u=new a({testKey:d});if("A"==u.getAbTestOptionByKey(d))return(r=e("<div/>",{id:n,class:o.type}).data({"carousel-feed-type":o.type})).appendTo(t),t.addClass("full-width"),function(e){coupangWebRequire(["common/components/dist/jikgu-widget-alog"],(function(t){c.checkWidgetInViewPort(n,o,s),e.on("jikgu-group-a-empty-body.impression",(function(e){u.loggingOnce()})),new t(e).render()}))}(r),!1;(r=e("<div/>",{id:n,class:o.type+" carousel-widget-container "+[].join(" ")}).data({"carousel-feed-type":o.type})).appendTo(t),t.addClass("full-width"),function(t,a){coupangWebRequire(["common/components/dist/jikgu-widget"],(function(r){c.checkWidgetInViewPort(n,o,s),t.on("promotion-decker-carousel.impression",(function(t){u.loggingOnce(),e(".carousel-widget-container."+a.type).trigger("carousel."+a.type+".visible"),c.impressionLogList[n]=a.impressionLogging||{};var i=c.impressionLogList[n];i.widgetType=l,i.numVisibleItems=t.unitCount})),t.on("promotion-decker-carousel.item.click",(function(t){var n=e(t.target).data("clickLogging")||{};n.widgetType=l,i.clickLogWithoutEventParam({id:"click_personalized_gw",param:n})})),t.on("promotion-decker-carousel.nav.click",(function(t){if(e(t.target).hasClass("next"))for(var i in c.impressionLogList){var o=c.impressionLogList[i];if(i===n){try{o.numVisibleItems=t.reachUnitCount}catch(e){}break}}})),new r(t,{pageSize:5,step:1}).render(a)}))}(r,o)},renderWidget:function(i,a,r,c){var d=this;coupangWebRequire(["fodiumWidgetLoader","text!template/home/alsoViewedProducts.html"],(function(l,u){var m=e("#header").data("abShowFbi"),p=t.compile(u),g=e(p({containerId:a,showFbi:m,feed:encodeURIComponent(JSON.stringify(r))}));g.addClass(r.type+" carousel-widget-container").data({"carousel-feed-type":r.type}),s===r.type?g.prependTo(i):g.appendTo(i),l&&l.load&&l.load(e(g),coupangWebRequire),g.on("widget.loaded",(function(){d.checkWidgetInViewPort(a,r,c),d.registerClickEvent(a);var t,i=e(".recommend-widget__item"),s={},l=r.productLists;for(t=0;t<l.length;t++)s[l[t].vendorItemId]=l[t].adsViewableImpressionUrl;i.each((function(e,t){var i=s[t.getAttribute("data-vendor-item-id")];i&&(t.setAttribute("data-view-impression",i),new n(t,i))})),setTimeout((function(){new o({target:"#"+a}).init()}),0)}))}))},checkExist:function(t){if(!t)return!1;var n=t.feeds;return!(!n||!e.isArray(n)||0===n.length)||(t.continuationToken&&this.fetchData(t.continuationToken),!1)},checkWidgetInViewPort:function(t,n,i){var o=this;e(window).on("scroll."+t,(function(){var a=document.getElementById(t).getBoundingClientRect();a.top>=0&&a.top<=e(window).height()&&(e(".carousel-widget-container."+n.type).trigger("carousel."+n.type+".visible"),o.handleImpressionLogData(t,n),i&&o.continuationToken&&o.fetchData(o.continuationToken),e(window).off("scroll."+t))})).trigger("scroll")},handleImpressionLogData:function(e,t){this.impressionLogList[e]=t.impressionLogging||{}},sendImpressionLog:function(e){i.impressionLog({id:"impression_personalized_gw",param:e},{isAsync:!1})},registerClickEvent:function(t){var n=this,o=e("#"+t);o.on("click",".recommend-widget__item a",(function(t){var n=e(t.currentTarget).data("clickLogging")||{};n.widgetType="",i.clickLogWithoutEventParam({id:"click_personalized_gw",param:n})})),o.on("click",".recommend-widget__arrow-button.next",(function(){for(var e in n.impressionLogList){var i=n.impressionLogList[e],o=i.numVisibleItems||0;if(e===t&&o<15){i.numVisibleItems=o+5;break}}}))},initEvent:function(){var e=this;window.onbeforeunload=function(){if(e.impressionLogList)for(var t in e.impressionLogList)e.sendImpressionLog(e.impressionLogList[t])}}}})),define("timeLog",["jquery","common/utils/perfTrack","HomeWebLogger"],(function(e,t,n){function i(){setTimeout((function(){var i=t.getPageTimingData(),o={dns:i.dns,connect:i.connect,ttfb:i.ttfb,serverTime:i.serverTime,download:i.download,domReady:i.domReady,loadTime:i.loadTime,network:i.network,customCss:t.getResourceTimingData("/main_new.min.css"),customJs:t.getResourceTimingData("/home.js"),customImg:t.getResourceTimingData(e(".main-today__bg.today-bg0").attr("src")),ttiLoggerJs:t.getResourceTimingData("/tti-logger.min.js"),couLogJs:t.getResourceTimingData("/cou-log.min.js"),requireJs:t.getResourceTimingData(/\/require.+js/)},a=e.extend({},{id:"web_latency_track_log",param:o}),s=t.getResourceTimingDataObject(e(".main-today__bg.today-bg0").attr("src"));n.latencyTrackLog(a,s)}),200)}return{timeLog:function(){window.performance&&window.performance.timing&&(window.performance.timing.loadEventEnd?i():e(window).load((function(){i()})))}}})),define("viewedAndRelatedProduct",["jquery","common/template/urlBuilder","common/utils/stringUtils","common/baseAction","home/rocketBadge","common/essentialData"],(function(e,t,n,i,o,a){"use strict";var s="#latestViewedProducts",r="#latestViewedProducts .latest-viewed-product",c="#latestViewedProducts .latest-viewed-recommendation",d="#recommend_",l={el:{$viewedWrapper:"",$viewedProductList:""},init:function(){var t=this;e(r).hide(),l.getViewedProduct().done((function(){t.el.$viewedWrapper=e(r),t.el.$viewedProductList=t.el.$viewedWrapper.find("li"),t.bindMouseOverEvent(),t.bindListClickEvent(),t.bindRollingBtnClickEvent(),t.bindDeleteBtnClickEvent(),e(l.el.$viewedProductList.not(":hidden")[0]).trigger("click")}))},getViewedProduct:function(){return e.ajax({type:"GET",contentType:"text/html",url:t.buildRequestUrl("/np/home/recently-viewed"),beforeSend:function(){e(s).html('<div class="loading-noti-area_"><p class="loading-noti">Loading...</p></div>')},complete:function(){e(".loading-noti-area_").remove()},success:function(e){l.showViewedProduct(e)},error:function(){e(s).remove()}})},showViewedProduct:function(t){t?e(s).show():e(s).remove(),e(s).append(t),i.slide_home({slider:e(".latest-viewed-product"),size:4})},bindMouseOverEvent:function(){this.el.$viewedWrapper.on({mouseenter:function(){4<l.el.$viewedProductList.size()&&e(this).children("a.move").show()},mouseleave:function(){e(this).children("a.move").hide()}})},bindListClickEvent:function(){this.el.$viewedWrapper.on("click","li",(function(){var t,n;t=e(this),n=e(l.el.$viewedProductList.not(":hidden")).index(this),t.hasClass("on")||(t.siblings().removeClass("on"),u.getRecommendProduct(t.attr("class"),"PRODUCT"===t.data("producttype"),n),t.addClass("on"))}))},bindRollingBtnClickEvent:function(){this.el.$viewedWrapper.on("click","a.move",(function(){e(l.el.$viewedProductList.not(":hidden")[0]).trigger("click")}))},bindDeleteBtnClickEvent:function(){e(".latest-viewed-item-delete").on("click",(function(n){n.preventDefault();var i=e(this).data("productid");e.ajax({type:"DELETE",url:t.buildRequestUrl("/np/home/remove-recently-viewed?productId="+i),dataType:"text",cache:!1,context:this,xhrFields:{withCredentials:!0},success:function(e){l.init()},error:function(e){alert(Pacifik.formatMessage("coupang.web.ff1379","삭제가 안됐나요? 다시 한번 해보세요."))}})}))}},u={getRecommendProduct:function(t,i,o){var a=e(d+t);a.length?(e(c).hide(),a.show()):e.ajax({type:"GET",url:"/np/recentlyViewedProducts/"+t+"/relatedProducts",dataType:"HTML",data:{isProduct:i,pivot:o},success:function(e){n.trim(e)&&u.showRecommendProduct(e,t)},error:function(){}})},showRecommendProduct:function(t,n){e(c).hide(),e(s).append(t),i.slide_home({slider:e(d+n),size:5}),"B"===a.getAbTestOptionByKey("2449")&&new o(e(d+n));var r=e(t).find("a.product").data("recommendationlog1"),l="";e(t).find("a.product").each((function(t){0==t?l=e(this).data("recommendationlog2"):null!=e(this).data("recommendationlog2")&&(l=l+","+e(this).data("recommendationlog2"))}));var u={eventAction:"exposure",rmdValue:l},m={logCategory:"impression",logType:"",logLabel:"home",customURL:"recommendationInflow.pang",extraParam:r+"&"+e.param(u)};couLog.execManualLogging(m),e(".latest-viewed-recommendation a.product").click((function(){var t={eventAction:"click",rmdValue:e(this).data("recommendationlog2")},n={logCategory:"event",logType:"click",logLabel:"home",customURL:"recommendationInflow.pang",extraParam:r+"&"+e.param(t)};couLog.execManualLogging(n)}))},bindEvent:function(){e(s).on({mouseenter:function(){var t=e(this);5<t.find("li").length&&t.children("a.move").show()},mouseleave:function(){e(this).children("a.move").hide()}},".latest-viewed-recommendation")}};return function(){l.init(),u.bindEvent()}})),define("wideTodaysHot",["jquery","weblog","HomeWebLogger"],(function(e,t,n){return{config:{rollingTimer:"",rollingSpeed:2e3,selectedSpeed:2e3,size:0},container:"",item:"",c1BannerIdsCollects:[],index:0,today:function(t,i,o,a,s){var r=this;this.container=e(t).find("ul"),this.item=e(this.container).find("li"),this.index=this.item.index(e(".today-selected")),this.config.size=e(this.item).size(),this.config.speed=o,this.config.selectedSpeed=a,this.config.rolling=i,this.config.rollingSpeed=this.config.speed,e(this.container).find(".mask").on("mouseover",e.proxy((function(t){var i=e(t.target).closest(".todayshot-right-thumbnail");if(0!==i.size()&&!i.hasClass("today-selected")){r.index=i.index(),r.item.removeClass("today-selected"),r.changeImage(r.index),i.hasClass("today-selected")||i.addClass("today-selected");var o=i.find("a").data("log-props");if(o){var a=o.bannerId?o.bannerId:this.index;this.config.size>0&&-1==this.c1BannerIdsCollects.indexOf(a)&&(n.impressionLog({id:o.impressionId,extra:o.extra,param:o.param},{isAsync:!0}),this.c1BannerIdsCollects.push(a))}}}),this)),this.config.rolling&&(s?"true"===e(t).attr("c1-images-loaded")?this.handlingRolling():e(t).on("c1-images-loaded",(function(){r.handlingRolling()})):this.handlingRolling())},handlingRolling:function(){var t=this;this._rollingHandled||(e(".main-today__selected-product").on({mouseover:function(e){t.rollingFn("stop"),t.config.rollingSpeed=t.config.selectedSpeed,t.rollingFn("start")},mouseout:function(e){t.rollingFn("stop"),t.config.rollingSpeed=t.config.speed,t.rollingFn("start")}}),t.rollingFn("start"),this._rollingHandled=!0)},setImageSrc:function(){this.container.find("img").attr("src",(function(){return e(this).data("imgsrc")}))},buttonFunc:function(t){"next"===t?(this.index++,this.index>this.config.size-1&&(this.index=0)):(this.index--,this.index<0&&(this.index=this.config.size-1));var i=e(this.item),o=i.eq(this.index),a=o.find("a").data("log-props");if(a){var s=a.bannerId?a.bannerId:this.index;this.config.size>0&&this.c1BannerIdsCollects.length<this.config.size&&-1==this.c1BannerIdsCollects.indexOf(s)&&(this.c1BannerIdsCollects.push(s),n.impressionLog({id:a.impressionId,extra:a.extra,param:a.param},{isAsync:!0}))}i.removeClass("today-selected"),o.addClass("today-selected"),this.changeImage(this.index)},rollingFn:function(e){var t=this;"start"===e?this.config.rollingTimer=setInterval((function(){t.buttonFunc("next")}),this.config.rollingSpeed):clearInterval(this.config.rollingTimer)},changeImage:function(t){var n=e(".main-today__img-container a"),i=e(".main-today>img");n.hide(),i.hide(),e(n[t]).show(),e(i[t]).show()}}})),define("wowFeeChangePopup",["jquery","lodash","common/utils/cookieUtils","handlebars"],(function(e,t,n,i){var o="",a=e("#wowFeeChangePopup"),s=a.data()||{},r=s.wowFeeChangePopup&&s.wowFeeChangePopup.initialServerDateTime-(new Date).getTime()||0,c=!1,d=s.wowFeeChangePopup&&s.wowFeeChangePopup.abOption||"",l=s.wowFeeChangePopup&&s.wowFeeChangePopup.tracking||!1,u=n.getValue("member_srl"),m="",p="",g="",h=s.wowFeeChangePopup&&s.wowFeeChangePopup.wowFeeChangeConsentCxIt4Option||"A",f=s.wowFeeChangePopup&&s.wowFeeChangePopup.isWowSavingAmountLessThanWowFeeAmount,y=s.wowFeeChangePopup&&s.wowFeeChangePopup.recentOrderInfo,w=s.wowFeeChangePopup&&s.wowFeeChangePopup.wowBenefitUsageDetails&&s.wowFeeChangePopup.wowBenefitUsageDetails.totalAmount||-1,v=s.wowFeeChangePopup&&s.wowFeeChangePopup.tcWeblogClick,b={renderBenefitPopup:function(){coupangWebRequire(["text!template/loyalty/wowFeeChange/benefitPopup.html"],(function(t){k.udpateLastAcknowledgeTime(),C.agreeOrDecideLaterClickLog("decide_later",!0);var n=i.compile(t),o=e(n(s));a.html(o)}))},renderLoyaltyAgreementPopup:function(){coupangWebRequire(["text!template/loyalty/wowFeeChange/loyaltyAgreementPopup.html"],(function(t){var n=i.compile(t),o=e(n(s));a.html(o)}))},renderNoticePopup:function(t){"A"===h?coupangWebRequire(["text!template/loyalty/wowFeeChange/noticePopup.html"],(function(n){var o=JSON.parse(JSON.stringify(s.wowFeeChangePopup||{}));o.showStaticBenefits="C"===d||"F"===d,o.placeDecideLaterButtonOnBottom="D"===d;var r=i.compile(n),c=e(r(o));a.show(),a.html(c),b.initializeBenefitsSwiper(),b.bindEvent(),_.disablePageScroll(),t&&C.noticePopupImpressionLog()})):this._renderNoticePopupV4(s.wowFeeChangePopup,t)},_renderNoticePopupV4:function(t,n){coupangWebRequire(["text!template/loyalty/wowFeeChange/noticePopupV4.html"],(function(o){var s="B"===h,r="C"===h,c=t.isWowSavingAmountLessThanWowFeeAmount,d=!1,l=!1;s?(c||(d=!0),l=!0):r&&(t.recentOrderInfo?d=!0:(c||(d=!0,s=!0,r=!1),l=!0)),t.noticePopupV4OptionB=s,t.noticePopupV4OptionC=r,t.optionOverThreashold=d,t.isDark=l;var u=t.wowBenefitUsageDetails&&t.wowBenefitUsageDetails.totalAmount||0;(t.formattedSavingAmount=Pacifik.formatNumber(u,"long"),t.formattedFutureWowFeeAmount=Pacifik.formatNumber(t.futureWowFeeAmount,"long"),t.recentOrderInfo)&&(t.recentOrderInfo.additionalProductCount>99&&(t.recentOrderInfo.additionalProductCount=99));var m=i.compile(o),p=e(m(t));a.show(),a.html(p),b.bindEvent(),_.disablePageScroll(),n&&C.noticePopupImpressionLog()}))},initializeBenefitsSwiper:function(){var t=e(".benefits_display_in_static").length>0;"function"!=typeof Swiper||t||(new Swiper(".swiper-container",{slidesPerView:1,centeredSlides:!0,grabCursor:!0,loop:!0,speed:500,autoplay:{delay:2e3,disableOnInteraction:!1},pagination:{el:".swiper-pagination",clickable:!0},navigation:{nextEl:".swiper-next",prevEl:".swiper-prev"},on:{touchStart:function(){k.udpateLastAcknowledgeTime(),o=e(".swiper-slide-active").data("benefitType")},touchEnd:function(){var t=e(".swiper-slide-active").data("benefitType");o&&t!==o&&C.benefitSwipeAndClickLog(o,t),o=""},transitionEnd:function(){_.updateBenefitTypeForWeblog()}}}),_.updateBenefitTypeForWeblog())},bindEvent:function(){e(window).off("message").on("message",(function(t){var n=t.originalEvent.data;try{e.isPlainObject(n)&&n.type?action=n:action=JSON.parse(n)}catch(e){action={type:n}}"frame.close"===action.type?b.renderNoticePopup():"closeWowPopup"===action.type&&b.closePopup()})),e("#loyalty-fee-change-decide-later-button").on("click",(function(){c||(v&&C.consentClickLog(!1,"decide_later"),s.wowFeeChangePopup&&"B"===s.wowFeeChangePopup.tcWowDecideLater?(k.udpateLastAcknowledgeTime(),C.agreeOrDecideLaterClickLog("decide_later",!0),T.handleClickDecideLaterButton({success:function(e){e.result?b.closePopup():_.showNetworkErrorAlert(e.isAgreedBefore)},fail:function(){_.showNetworkErrorAlert()}})):(l&&T.addTracking(),s.wowFeeChangePopup&&"C"===s.wowFeeChangePopup.tcWowDecideLater&&T.recordDecideLaterActive(),b.renderBenefitPopup()))})),e("#loyalty-fee-change-agree-button").on("click",(function(){c||(v&&C.consentClickLog(!1,"agree"),c=!0,k.udpateLastAcknowledgeTime(),T.agreeWowFeeChange({success:function(e){e.result?(k.udpateDisableWowMembershipAgreement(),C.agreeOrDecideLaterClickLog("agree",!0),b.closePopup()):_.showNetworkErrorAlert(e.isAgreedBefore)},fail:function(){_.showNetworkErrorAlert(!1)}}))})),e("#loyalty-fee-change-show-tnc-button").on("click",(function(){C.checkAgreementClickLog(),k.udpateLastAcknowledgeTime(),b.renderLoyaltyAgreementPopup()})),e(".swiper-prev").on("click",(function(){k.udpateLastAcknowledgeTime(),C.benefitSwipeAndClickLog(p,m)})),e(".swiper-next").on("click",(function(){k.udpateLastAcknowledgeTime(),C.benefitSwipeAndClickLog(p,g)}))},closePopup:function(){_.enablePageScroll(),a.remove()}},_={effectiveDateAndSavingAmount:null,enablePageScroll:function(){e("html").css("overflow-y","scroll")},disablePageScroll:function(){e("html").css("overflow-y","hidden")},getFormattedEffectiveDate:function(e){if(e){var t=(new Date).getFullYear(),n=function(e){return e.replace(/^(\d)$/,"0$1")};return e.replaceAll(/(\d+)월\s*(\d+)일/gi,(function(e,i,o,a){return t+n(i)+n(o)}))}return""},getEffectiveDateAndSavingAmount:function(){if(!this.effectiveDateAndSavingAmount){var t=this.getFormattedEffectiveDate(e(".wow-fee-change-popup-notice-popup").data("effectiveDate")),n=e(".loyalty-fee-change-contents__carousel-description"),i=-1;n.length&&n.data("budAmount")&&(i=n.data("budAmount")),this.effectiveDateAndSavingAmount={effectiveDate:t,savingAmount:i}}return this.effectiveDateAndSavingAmount},showNetworkErrorAlert:function(t){var n=e("#network-error"),i=e("#already-agree-error");t?(e(".wow-fee-change-popup-error-alert-mask-already-agree").show(),i.find(".error-mask-close-btn").off("click").on("click",(function(){b.closePopup()}))):(e(".wow-fee-change-popup-error-alert-mask").show(),n.find(".error-mask-close-btn").off("click").on("click",(function(){b.closePopup()}))),t?C.sendAlreadyAgreedLog():C.agreeRequestFailureAlertImpressionLog()},updateBenefitTypeForWeblog:function(){m=e(".swiper-slide-prev").data("benefitType"),p=e(".swiper-slide-active").data("benefitType"),g=e(".swiper-slide-next").data("benefitType")}},k={udpateLastAcknowledgeTime:function(){var e=(new Date).getTime();n.setCookie("gwFeeChangeLastAckDateTime_"+u,e+r,{timeUnit:"MONTH",timeValue:1}),n.setCookie("globalLastAcknowledgeTime_"+u,e+r,{timeUnit:"MONTH",timeValue:1})},udpateDisableWowMembershipAgreement:function(){n.setCookie("wowAgreementAgreed_"+u,"true",{timeUnit:"MINUTE",timeValue:1})}},C={submitLog:function(e){CoupangWebLog&&CoupangWebLog.submit(e)},sendABExposureLog:function(e,t){this.submitLog({meta:{schemaId:13452,schemaVersion:1},data:{domain:"home",pageName:"home",eventName:"ab_test_exposure",logCategory:"impression",logType:"impression",abGroup:e,abTestId:t||"54933"}})},_processLogDataV2:function(e){e.hasBenefitOverThreshold=null,"A"!==h&&("B"===h?(e.hasBenefitOverThreshold=!f,e.personalSavingsAmount=f?-1:w):e.hasBenefitOverThreshold=!!y||!f),e.personalSavingsAmount=f?-1:w},agreeOrDecideLaterClickLog:function(e,t){var n=_.getEffectiveDateAndSavingAmount(),i={domain:"home",pageName:"home",eventName:"home_wow_agreement_popup_cta_click",logCategory:"event",logType:"click",clickType:e,effectiveDate:n.effectiveDate,personalSavingsAmount:n.savingAmount,benefitType:p,isSubmitSuceed:t?"Y":"N"};this._processLogDataV2(i),this.submitLog({meta:{schemaId:14115,schemaVersion:2},data:i})},consentClickLog:function(e,t){const n={domain:"home",pageName:"home",eventName:"gw_fee_change_force_click_debug_log",logType:"click",logCategory:"event",isForce:e,consentClickType:t};this.submitLog({meta:{schemaId:15055,schemaVersion:1},data:n})},checkAgreementClickLog:function(){var e=_.getEffectiveDateAndSavingAmount(),t={domain:"home",pageName:"home",eventName:"home_wow_agreement_popup_other_click",logCategory:"event",logType:"click",clickType:"terms_conditions",effectiveDate:e.effectiveDate,personalSavingsAmount:e.savingAmount};this._processLogDataV2(t),this.submitLog({meta:{schemaId:14116,schemaVersion:2},data:t})},benefitSwipeAndClickLog:function(e,t){var n=_.getEffectiveDateAndSavingAmount(),i={domain:"home",pageName:"home",eventName:"home_wow_agreement_popup_benefit_swipe_click",logCategory:"event",logType:"click",effectiveDate:n.effectiveDate,personalSavingsAmount:n.savingAmount,currentBenefitType:e,postBenefitType:t};this.submitLog({meta:{schemaId:14136,schemaVersion:1},data:i})},noticePopupImpressionLog:function(){var e=_.getEffectiveDateAndSavingAmount(),t={domain:"home",pageName:"home",eventName:"home_wow_agreement_popup_impression",logCategory:"impression",logType:"impression",effectiveDate:e.effectiveDate,personalSavingsAmount:e.savingAmount};this._processLogDataV2(t),this.submitLog({meta:{schemaId:14114,schemaVersion:2},data:t}),this.sendABExposureLog(d)},agreeRequestFailureAlertImpressionLog:function(){this.submitLog({meta:{schemaId:14195,schemaVersion:1},data:{domain:"home",pageName:"home",eventName:"home_wow_agreement_normal_api_failure_alert_impression",logCategory:"impression",logType:"impression"}})},sendAlreadyAgreedLog:function(){var e=_.getEffectiveDateAndSavingAmount();CoupangWebLog.submit({meta:{schemaId:14197,schemaVersion:1},data:{domain:"loyalty",logCategory:"impression",logType:"impression",pageName:"wow_agreement_landing",eventName:"loyalty_wow_agreement_already_agreed_alert_impression",effectiveDate:e.effectiveDate,personalSavingsAmount:e.savingAmount,wowConsentOptionType:"agree_or_decide_later",titleType:"agree"}})}},T={agreeWowFeeChange:function(t){var n={agreed:!0,sourcePage:"HOME"};l&&(n.subPage="POPUP"),e.ajax({url:"/vp/notice/wow-fee-change/agreement",type:"POST",cache:!1,data:n,success:function(e){t.success&&t.success(e)},error:function(){t.fail&&t.fail()}})},recordDecideLaterActive:function(t){var n={sourcePage:"HOME"};l&&(n.subPage="POPUP"),e.ajax({url:"/vp/notice/wow-fee-change/decide-later",type:"POST",cache:!1,data:n,success:function(e){t&&t.success&&t.success(e)},error:function(){t&&t.fail&&t.fail()}})},handleClickDecideLaterButton:function(e){this.recordDecideLaterActive(e)},addTracking:function(){e.ajax({url:"/vp/notice/tracking",type:"GET",cache:!1,data:{subPage:"POPUP",sourcePage:"HOME",action:"CLICK_DECIDE_LATER"}})}};return{initialize:function(){"A"===d?C.sendABExposureLog(d):a.length&&b.renderNoticePopup(!0)}}})),define("wowSignupPopup",["jquery"],(function(e){var t=e("#wowSignupPopup"),n=t.data(),i=e("#basemembersrl").data("basemembersrl")+"wow-signup-popup",o=null;return{initialize:function(){t.length>0&&n.wowSignUpCxUrl&&function(e){try{var t=window.localStorage.getItem(e);if(t){var n=JSON.parse(t).data;return n.expire&&Date.now()>n.expire}return!0}catch(e){return!1}}(i)&&(function(e,n){t.show(),e.on("load",(function(){!function(e){window.addEventListener("message",(function(n){var i=null;if("https://loyalty.coupang.com"===n.origin){try{i=JSON.parse(n.data)}catch(e){}switch(i&&i.type){case"frame.close":return void(o?setTimeout((function(){o.close(),o=null}),100):t.hide());case"frame.change.size":var a=i.payload.delay||0;return void setTimeout((function(){i.payload.width&&e.width(i.payload.width),i.payload.height&&e.height(i.payload.height)}),a);case"frame.open.tnc":return void(o=window.open("https://loyalty.coupang.com/loyalty/sign-up/agreement/index","tncPopup","left=100,top=100,width=404,height=697"));case"frame.go.to":return void(i.payload.url&&(window.location.href=i.payload.url));case"location.href":case"register.success":return void t.hide()}}else"https://rocketpay.coupang.com"===n.origin&&"closeRocketpay"===(i=n.data)&&t.hide()}))}(e)})),e.attr("src",n.wowSignUpCxUrl)}(e("#wowSignupPopup > iframe"),n),function(e){var t=new Date;t.setDate(t.getDate()+14),window.localStorage.setItem(e,JSON.stringify({data:{expire:t.getTime()}}))}(i))}}})),define("commonUtils",(function(){return{getUrlParameters:function(e){var t={};if(!e)return t;var n=e.indexOf("?"),i=n>=0?e.substr(n+1):e,o=(n=i.indexOf("#"))>=0?i.substr(0,n):i;return o&&o.split("&").forEach((function(e){var i=(n=e.indexOf("="))>=0?e.substr(0,n):e,o=n>=0?e.substr(n+1):"";i.length>0&&(t[i]=o)})),t},getProductId:function(e){var t=/.+\bproducts\/(\d+)\?/gi.exec(e);return t[1]?parseInt(t[1],10):0}}}));